#!/usr/bin/env zsh

remote_name="neuchatel"
remote_url="https://gitlab.com/scrolliris/neuchatel.git"
remote_branch="master"

subtree_dir="locale"

git remote get-url $remote_name

if [ "${?}" -ne "0" ]; then
  git remote add $remote_name $remote_url
fi

subtree=$( \
  git log | \
  grep git-subtree-dir | \
  tr -d ' ' | \
  cut -d ":" -f2 | \
  sort | \
  uniq |
  grep $subtree_dir
)

if [ "${subtree}" = "" ]; then
  git subtree add --prefix $subtree_dir $remote_name ${remote_branch}
fi

git pull -s subtree -Xsubtree=${subtree_dir} ${remote_name} ${remote_branch}
